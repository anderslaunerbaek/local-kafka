```sql
CREATE STREAM CONSUMPTIONSCHEMA (
  ID VARCHAR KEY,
  CONSUMPTION_VALUE DOUBLE,
  DT_START TIMESTAMP,
  DT_END TIMESTAMP 
) WITH (
  KAFKA_TOPIC = 'CONSUMPTIONSCHEMA',
  PARTITIONS = 20, 
  VALUE_FORMAT = 'avro'
);   
CREATE STREAM PRICESCHEMA (
  ID VARCHAR KEY,
  PRICE_VALUE DOUBLE,
  DT_START TIMESTAMP,
  DT_END TIMESTAMP 
) WITH (
  KAFKA_TOPIC = 'PRICESCHEMA',
  PARTITIONS = 1, 
  VALUE_FORMAT = 'avro'
); 

CREATE TABLE PRICESCHEMA_LATEST WITH(KEY_FORMAT='AVRO') as SELECT LATEST_BY_OFFSET(ID), DT_START, DT_END, LATEST_BY_OFFSET(PRICE_VALUE) PRICE_VALUE FROM PRICESCHEMA GROUP BY DT_START, DT_END EMIT CHANGES;


# CREATE TABLE CONSUMPTIONSCHEMA WITH(KEY_FORMAT='AVRO') as SELECT * FROM CONSUMPTIONSCHEMA EMIT CHANGES;


create stream METADATA1 with(kafka_topic='metadata1', value_format='avro');
```